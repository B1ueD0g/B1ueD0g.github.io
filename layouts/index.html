{{- define "main" }}
{{- $quickTags := site.Params.searchQuickTags | default (slice "零信任" "AI安全" "数据安全" "漏洞研究" "标准解读") -}}
<article class="first-entry home-info">
  <header class="entry-header">
    <h1>{{ site.Params.homeInfoParams.Title | default "He is Exploring Everything." }}</h1>
  </header>

  <div class="home-search-wrap">
    <div class="home-search-box">
      <input
        id="home-search-input"
        type="search"
        placeholder="输入关键词后回车，可直接跳转到最佳结果"
        aria-label="Search posts"
      />
      <button id="home-search-btn" type="button">Search</button>
    </div>

    <div class="home-search-tags">
      <span>Try Tags:</span>
      {{- range $quickTags }}
      <a href="/search/?q={{ . | urlquery }}">#{{ . }}</a>
      {{- end }}
    </div>
  </div>
</article>

<script>
  window.addEventListener("DOMContentLoaded", function () {
    var input = document.getElementById("home-search-input");
    var button = document.getElementById("home-search-btn");
    if (!input || !button) return;

    function submitSearch(autoJump) {
      var keyword = input.value.trim();
      var params = new URLSearchParams();
      if (!keyword) {
        window.location.href = "/search/";
        return;
      }
      params.set("q", keyword);
      if (autoJump) params.set("autojump", "1");
      window.location.href = "/search/?" + params.toString();
    }

    button.addEventListener("click", function () {
      submitSearch(false);
    });
    input.addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        event.preventDefault();
        submitSearch(true);
      }
    });
  });
</script>
{{- end }}
